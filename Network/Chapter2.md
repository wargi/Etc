#  Chapter 2: 신호의 전송과 충돌 #

## 1. 1계층의 역할과 개요
- 1계층의 역할: 케이블이 연결되어 있는 기기에 신호를 전달한다.
- 주로 사용되는 케이블
  1. UTF
  2. 광파이버
- 인터페이스: 케이블로 전달된 신호를 데이터(비트)로 변경해준다.
- 인터페이스는 LAN과 WAN 케이블에 따라 접속하는것이 다르다.
  1. NIC: LAN용 케이블(거의 컴퓨터에 달려져 있다.)
  2. DCE: WAN용 케이블

## 2. 신호와 충돌
- 신호의 형태나 전송 방법에 의해 통신속도가 정해진다.
- 신호는 감쇠, 노이즈/간섭 충돌 등의 문제가 발생한다.
  1. 감쇠: 장거리 케이블을 지나는 동안 저항에 의해 신호가 약해진다.
  2. 노이즈: 외적 요인(기상, 열, 다른 케이블 등)에 의해 신호의 진폭이 변화한다.
  3. 충돌: 동일 케이블상(멀티액세스 네트워크)에 동시에 전송된 신호가 충돌해 전하를 주고받게 됨으로써 진폭이 붕괴된다.
- 케이블에 쉴드처리를 해서 간섭이나 노이즈를 막는다.(광파이버는 빛 임으로 노이즈나 간섭을 받지 않는다.)

## 3. 허브
- 허브에 케이블로 연결되어 있는 기기는 동일 케이블에 연결되어 있는 것하고 같은 취급을 받는다.
- 허브의 기능
  1. 신호의 증폭과 재생
  2. 복수의 기기를 연결해서 네트워크를 구축
- 허브의 특징: 허브에 연결된 기기들은 동일 케이블이라 여기기 때문에 수신한 포트 이외에 허브에 연결된 모든 포트에 수신한 신호를 송신하게 되는데 이 것을 플러딩(Flooding)이라고 한다.
- 허브의 특징으로 인해 신호를 송신 중에 수신이 오면 충돌이 발생할 수 있는데 이 것을 충돌 도메인이라고 하며 충돌 도메인의 범위는 허브에 연결된 컴퓨터나 연속접속으로 연결된 모든 범위가 충돌 도메인이 된다.
- 충돌 도메인은 작아야 한다.
- 연속접속: 허브의 포트 수보다 컴퓨터 수가 많을 시에 허브끼리 연결하는 것.

## 4. 2계층의 역할과 개요
- 2계층은 신호가 도달하는 범위에서의 데이터의 송수신을 생각한다.
- 2계층에서도 WAN과 LAN의 규칙이 다르다.
- LAN의 규칙은 사실표준인 이더넷을 채용한다.
- 프레이밍: 이더넷에서 사용하는 몇 가지 규칙중 하나이다.
  1. 프레이밍은 1계층에서 주고받는 신호를 비트화 해준다.
  2. 프레이밍은 쉽게 생각하면 프레임화라고 볼 수 있다.
  3. 프레이밍에는 프리엠블(지금부터 프레임이 시작된다는 신호)을 보내는데 시작타이밍을 프리엠블이 알려 주어 이를 기반으로 비트를 읽을 타이밍 알 수 있게 된다.

## 5. 2계층 주소와 이더넷
#### 1) 데이터 전송

- 이더넷에서 어떻게 '신호가 도달하는 범위에서 데이터를 송/수신하는지'를 설명할 때 기억해둬야 할건 주소(Address)다. 그리고 이 주소를 어떻게 사용할지 어떻게 배정할지 정하는 건 어드레싱(Addressing)이라고 한다.

- 주소란 데이터를 보내는 상대와 자신을 특정하는 데이터라고 말한다.

- 데이터 통신에서는 기본적으로 보내는 주소와 받는 주소의 정보가 필요하다.

- 데이터 전송 방법에 따라 3종류가 있다.

  1. 유니캐스트(Uni-cast): '1대 1' 데이터 통신 (이게 가장 일반적이다)

  2. 브로드캐스트(Broadcast): '1대 전체' (전원, 즉 모두에게 메시지를 보내는 통신)

     > - 2 계층의 브로드캐스트는 세그먼트 내의 모든기기에로 데이터 통신을 의미

  3. 멀티캐스트(Multicast): '1대 다수' (지정된 복수의 기기로 메시지를 보내는 데이터 통신)

-  한 개의 컴퓨터는 각각의 유니캐스트 최소한 1개이상의 주소를 가지고 있다.

-  한 개의 컴퓨터에 유니캐스트 주소말고도 멀티캐스트 주소가 있을 수 있는데 이건 그룹번호라고 생각을 하면 된다.

   > 예를 들어, 수신처가 '박상욱'인건 유니캐스트로 나한테 전달을 하는 것이고, '박상욱의 가족'인건 멀티캐스트로 니힌테 전달한다.

#### 2) MAC 주소

- 이더넷에서 사용되는 주소는 'MAC(Media Access Control) 주소라고 불리는 주소로 이주소는 인터페이스에 지정된 고정 주소이다.

  > - 인터페이스에 지정된 고정된 주소이기 때문에 인터페이스가 변경되면 당연히 주소도 변경된다.

- MAC주소는 48비트로 값으로 4비트마다 16진수로 고쳐서 쓴다.

- 선두 24비트는 벤더코드라고 불리는 인터페이스를 제조한 메이커의 번호이고, 후반의 24비트는 제조한 메이커가 붙힌 번호다.

  > - 00000000 | 00001101 | 01100001 | 01110110 | 01101101 | 01101110 
  >
  >   ​       00      |       0D      |       61       |        76       |       6D      |       6E       
  >
  >   ​                     벤더코드                     |                   벤더 할당 코드

## 6. 이더넷
#### 1) 이더넷 프레임

- 이더넷에서 데이터그램에 이더넷 헤더와 이더넷 트레일러를 붙인다.

  > - 이더넷 헤더: 송/수신 측 MAC주소와 페이로드의 내용을 식별하는 타입
  >
  > - 이더넷 트레일러: 에러를 체크하는 FCS(Frame Check Sequence)
  >
  >   > - FCS는 에러가 발생한 사실은 알 수 있지만 막상 에러를 고칠 수는 없다.
  >   >
  >   > - 허밍부호라고 불리는 에러 체크 코드를 붙이면 고칠 수 있지만 복수의 비트가 에러인 경우에는 허밍부호로도 불가능하다.
  >   > - 결국은 송신측에 확인해보는 경우 밖에 없는데 통신중에는 에러를 수정할 수 없기 때문에 에러가 난 프레임의 경우 파기한다.

#### 2) 이더넷 동작

- 수신: 멀티액세스 네트워크를 예를 들어 이더넷을 수신했을 때 허브의 플러딩에 의해 허브에 연결된 모든 기기에 신호가 수신되는데 이더넷에서는 수신한 프레임의 수신처 MAC주소(이더넷 헤더)를 보고 자기에게 온 것 외의 다른 프레임을 파기한다. (유니캐스트)

  > - 멀티캐스트는 멀티캐스트 주소(그룹 번호)에 의해 자신이 멀티캐스트 주소에 속해 있다면 수신, 그 외 경우는 파기
  > - 브로드캐스트는 전체수신이기 때문에 반드시 수신

- 충돌: 이더넷에서는 '신호를 보내는 타이밍을 겹치지 않도록 비켜나게' 함으로써 '되도록 충돌이 일어나지 않도록' 하는데 이를 위해 CSMA/CD(Carrier Sense Multiple Access/Collsion Detection)라는 액세스 제어를 시행한다.

  > - CSMA/CD
  >   1. CS(신호 감지)는 누군가가 송신 중이라면 송신하지 않는다.
  >   2. MA(다중 액세스)는 아무도 송신하고 있지 않다면 송신할 수 있다.
  >   3. CD(충돌검사)는 송신 후에 충돌이 일어나면 다시 재수행 한다.

- CSMA/CD를 사용해도 충돌이 나는데 그건 2대가 거의 동시에 신호를 감지해버린 경우이다. 그 경우엔 2대 모두 '아무도 송신 하고 있지 않다'고 판단해서 2대가 송신하게 되어 충돌이 발생하는데 이부분은 신호 감지로도 막을 수 없다.

  > 그래서 '가능하면 충돌이 일어나지 않도록' 한다라고 한거 같다.

## 7. 스위치

#### 1) 허브와 스위치

- 충돌이 발생하지 않도록 하기 위해서는 '신호를 보내는 타이밍이 겹치지 않도록 엇갈리게 하는 방법'과 '신호가 지나가는 길을 나누는 방법'이 있다. 그 중에 신호가 지나는 길을 나누기 위한 기기가 '스위치(Switch)이다.

- 스위치도 허브와 마찬가지로 복수의 포트를 갖고 있어. 여러 대의 컴퓨터에 연결 하여 컴퓨터 사이에서 신호를 송수신 할 수 있다.

  > - 허브 스위치로 치환

(TIP) 현재 사용되고 있는 LAN에 사용되는 UTP나 광파이버 케이블은 '송신 신호'와 '수신 신호'가 나뉘어져 있는데 이를 쉽게 생각하며 신호가 나뉘어져 있기 때문에 신호가 동시에 지나쳐도 충돌은 발생하지 않는다. ( 그럼 충돌은 어디에서 나는 거지? 답은 바로 아래 !! )

- 충돌은 허브에서 발생하는데 그 이유는, 허브는 2개이상의 기기로 부터 신호를 수신하면 허브는 그것을 나누어 보낼 수가 없기 때문에 충돌이 발생한다.

#### 2) MAC 주소 필터링

- 허브에서 발생하는 충돌을 스위치가 안에서 수신한 프레임을 따로따로 보낼 수 있도록 처리해서 충돌을 막는다.

- 따로따로 처리하기 위해 스위치는 두가지의 동작을 수행하는데

  1. MAC 주소 필터링: '학습'과 '스위칭'이라는 동작으로 이루어져 있는데

     - 학습: 수신한 프레임의 송신처 MAC 주소를 기록하는데 이것으로 수신한 포트랑 MAC주소를 연관 짓는다.

       > - 어드레스 테이블: 학습에 의해 스위치는 포트에 연결되어 있는 컴퓨터의 MAC 주소를 기억한다. 즉, '이 포트에 이 MAC주소를 가진 컴퓨터가 있어"라고 만든 대응표를 어드레스 테이블이라 한다.

     - 스위칭: 프레임을 수신한 스위치는 프레임의 수신처 MAC 주소를 보고(어드레스 테이블) 그 MAC 주소가 있는 포트에서만 프레임을 송신한다.

  2. 

## 8. 전이중 이더넷
- 

## 9. Next Chapter Link
- [Chapter 3: IP 어드레싱](https://github.com/wargi/Etc/blob/master/Network/Chapter3.md)
